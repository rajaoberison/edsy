<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 6 Visualization | EDS Vignettes</title>
  <meta name="description" content="Data science resources for FES Students" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 6 Visualization | EDS Vignettes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Data science resources for FES Students" />
  <meta name="github-repo" content="rajaoberison/edsy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 6 Visualization | EDS Vignettes" />
  
  <meta name="twitter:description" content="Data science resources for FES Students" />
  

<meta name="author" content="Andry Rajaoberison" />


<meta name="date" content="2020-06-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cleaning.html"/>
<link rel="next" href="spatial.html"/>
<script src="libs/header-attrs-2.2/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">FES EDS Tutorials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="orientation.html"><a href="orientation.html"><i class="fa fa-check"></i><b>1</b> Orientation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="orientation.html"><a href="orientation.html#downloading-r-studio"><i class="fa fa-check"></i><b>1.1</b> Downloading R-Studio</a></li>
<li class="chapter" data-level="1.2" data-path="orientation.html"><a href="orientation.html#your-work-space"><i class="fa fa-check"></i><b>1.2</b> Your Work Space</a></li>
<li class="chapter" data-level="1.3" data-path="orientation.html"><a href="orientation.html#helpful-tools-for-learning-more"><i class="fa fa-check"></i><b>1.3</b> Helpful Tools for Learning More</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>2</b> Reading</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading.html"><a href="reading.html#explaining-working-directories"><i class="fa fa-check"></i><b>2.1</b> Explaining Working Directories</a></li>
<li class="chapter" data-level="2.2" data-path="reading.html"><a href="reading.html#loading-from-package-library"><i class="fa fa-check"></i><b>2.2</b> Loading from Package Library</a></li>
<li class="chapter" data-level="2.3" data-path="reading.html"><a href="reading.html#csv"><i class="fa fa-check"></i><b>2.3</b> CSV</a></li>
<li class="chapter" data-level="2.4" data-path="reading.html"><a href="reading.html#excel"><i class="fa fa-check"></i><b>2.4</b> Excel</a></li>
<li class="chapter" data-level="2.5" data-path="reading.html"><a href="reading.html#google-spreadsheets"><i class="fa fa-check"></i><b>2.5</b> Google Spreadsheets</a></li>
<li class="chapter" data-level="2.6" data-path="reading.html"><a href="reading.html#spss"><i class="fa fa-check"></i><b>2.6</b> SPSS</a></li>
<li class="chapter" data-level="2.7" data-path="reading.html"><a href="reading.html#rda"><i class="fa fa-check"></i><b>2.7</b> RDA</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="extraction.html"><a href="extraction.html"><i class="fa fa-check"></i><b>3</b> Extraction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="extraction.html"><a href="extraction.html#web-scraping"><i class="fa fa-check"></i><b>3.1</b> Web Scraping</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="structuring.html"><a href="structuring.html"><i class="fa fa-check"></i><b>4</b> Structuring</a>
<ul>
<li class="chapter" data-level="4.1" data-path="structuring.html"><a href="structuring.html#accessing-data-in-r"><i class="fa fa-check"></i><b>4.1</b> Accessing Data in R</a></li>
<li class="chapter" data-level="4.2" data-path="structuring.html"><a href="structuring.html#data-types"><i class="fa fa-check"></i><b>4.2</b> Data types</a></li>
<li class="chapter" data-level="4.3" data-path="structuring.html"><a href="structuring.html#inspecting-the-data"><i class="fa fa-check"></i><b>4.3</b> Inspecting the data</a></li>
<li class="chapter" data-level="4.4" data-path="structuring.html"><a href="structuring.html#subsetting-and-filtering"><i class="fa fa-check"></i><b>4.4</b> Subsetting and Filtering</a></li>
<li class="chapter" data-level="4.5" data-path="structuring.html"><a href="structuring.html#changing-cell-values"><i class="fa fa-check"></i><b>4.5</b> Changing cell values</a></li>
<li class="chapter" data-level="4.6" data-path="structuring.html"><a href="structuring.html#pivoting-the-dataset"><i class="fa fa-check"></i><b>4.6</b> Pivoting the dataset</a></li>
<li class="chapter" data-level="4.7" data-path="structuring.html"><a href="structuring.html#merging-two-dataframes"><i class="fa fa-check"></i><b>4.7</b> Merging Two Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>5</b> Cleaning</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cleaning.html"><a href="cleaning.html#fixing-skewed-distribution"><i class="fa fa-check"></i><b>5.1</b> Fixing skewed distribution</a></li>
<li class="chapter" data-level="5.2" data-path="cleaning.html"><a href="cleaning.html#treating-outliers"><i class="fa fa-check"></i><b>5.2</b> Treating outliers</a></li>
<li class="chapter" data-level="5.3" data-path="cleaning.html"><a href="cleaning.html#fixing-missing-values"><i class="fa fa-check"></i><b>5.3</b> Fixing missing values</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>6</b> Visualization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualization.html"><a href="visualization.html#simple-graphs-with-ggplot2"><i class="fa fa-check"></i><b>6.1</b> Simple graphs with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="visualization.html"><a href="visualization.html#setting-ggplot2-theme"><i class="fa fa-check"></i><b>6.1.1</b> Setting <code>ggplot2</code> theme</a></li>
<li class="chapter" data-level="6.1.2" data-path="visualization.html"><a href="visualization.html#ggplot2-example-1-stacked-bar-plot"><i class="fa fa-check"></i><b>6.1.2</b> <code>ggplot2</code> Example 1: Stacked bar plot</a></li>
<li class="chapter" data-level="6.1.3" data-path="visualization.html"><a href="visualization.html#ggplot2-example-2-grouped-bar-plot"><i class="fa fa-check"></i><b>6.1.3</b> <code>ggplot2</code> Example 2: Grouped bar plot</a></li>
<li class="chapter" data-level="6.1.4" data-path="visualization.html"><a href="visualization.html#ggplot2-example-3-scatterplot"><i class="fa fa-check"></i><b>6.1.4</b> <code>ggplot2</code> Example 3: Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="visualization.html"><a href="visualization.html#animated-graph-with-gganimate"><i class="fa fa-check"></i><b>6.2</b> Animated graph with <code>gganimate</code></a></li>
<li class="chapter" data-level="6.3" data-path="visualization.html"><a href="visualization.html#interactive-graph-with-plotly"><i class="fa fa-check"></i><b>6.3</b> Interactive graph with <code>plotly</code></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="visualization.html"><a href="visualization.html#plotly-example-1-interactive-version-of-the-stacked-bar"><i class="fa fa-check"></i><b>6.3.1</b> <code>plotly</code> Example 1: Interactive version of the stacked bar</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="visualization.html"><a href="visualization.html#web-app-with-rshiny"><i class="fa fa-check"></i><b>6.4</b> Web app with RShiny</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="visualization.html"><a href="visualization.html#input-functions"><i class="fa fa-check"></i><b>6.4.1</b> Input functions</a></li>
<li class="chapter" data-level="6.4.2" data-path="visualization.html"><a href="visualization.html#output-functions"><i class="fa fa-check"></i><b>6.4.2</b> Output functions</a></li>
<li class="chapter" data-level="6.4.3" data-path="visualization.html"><a href="visualization.html#server-function"><i class="fa fa-check"></i><b>6.4.3</b> Server function</a></li>
<li class="chapter" data-level="6.4.4" data-path="visualization.html"><a href="visualization.html#sharing-your-app"><i class="fa fa-check"></i><b>6.4.4</b> Sharing your app</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="visualization.html"><a href="visualization.html#more-data-visualization-resources"><i class="fa fa-check"></i><b>6.5</b> More data visualization resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>7</b> Spatial data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial.html"><a href="spatial.html#importing-spatial-data"><i class="fa fa-check"></i><b>7.1</b> Importing spatial data</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="spatial.html"><a href="spatial.html#reading-shapefile"><i class="fa fa-check"></i><b>7.1.1</b> Reading shapefile</a></li>
<li class="chapter" data-level="7.1.2" data-path="spatial.html"><a href="spatial.html#reading-raster"><i class="fa fa-check"></i><b>7.1.2</b> Reading raster</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="spatial.html"><a href="spatial.html#processing"><i class="fa fa-check"></i><b>7.2</b> Processing</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="spatial.html"><a href="spatial.html#creating-point-data"><i class="fa fa-check"></i><b>7.2.1</b> Creating point data</a></li>
<li class="chapter" data-level="7.2.2" data-path="spatial.html"><a href="spatial.html#joining-with-another-dataframe"><i class="fa fa-check"></i><b>7.2.2</b> Joining with another dataframe</a></li>
<li class="chapter" data-level="7.2.3" data-path="spatial.html"><a href="spatial.html#spatial-joining"><i class="fa fa-check"></i><b>7.2.3</b> Spatial joining</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="spatial.html"><a href="spatial.html#some-visualization-examples"><i class="fa fa-check"></i><b>7.3</b> Some Visualization Examples</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="spatial.html"><a href="spatial.html#plotting-charcoal-data"><i class="fa fa-check"></i><b>7.3.1</b> Plotting charcoal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>8</b> Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="analysis.html"><a href="analysis.html#working-with-survey-data"><i class="fa fa-check"></i><b>8.1</b> Working with survey data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="analysis.html"><a href="analysis.html#variable-standardization"><i class="fa fa-check"></i><b>8.1.1</b> Variable Standardization</a></li>
<li class="chapter" data-level="8.1.2" data-path="analysis.html"><a href="analysis.html#sample-weighting"><i class="fa fa-check"></i><b>8.1.2</b> Sample weighting</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="analysis.html"><a href="analysis.html#working-with-covid-19-data"><i class="fa fa-check"></i><b>8.2</b> Working with COVID-19 data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>9</b> Resources</a>
<ul>
<li class="chapter" data-level="9.1" data-path="resources.html"><a href="resources.html#data"><i class="fa fa-check"></i><b>9.1</b> Data</a></li>
<li class="chapter" data-level="9.2" data-path="resources.html"><a href="resources.html#eds-course-map"><i class="fa fa-check"></i><b>9.2</b> EDS Course Map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EDS Vignettes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualization" class="section level1" number="6">
<h1><span class="header-section-number">Section 6</span> Visualization</h1>
<div id="simple-graphs-with-ggplot2" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Simple graphs with <code>ggplot2</code></h2>
<p>GGPlot2 is one of the most universally applicable visualization packages currently available for R-Studio. It provides a set of tools that make it incredibly dynamic and versatile. As such, we will provide an introductory examination of some of the best features that you can integrate into your analysis.</p>
<p>Data visualization is about telling the story of the data in a digestible way and highlighting key traits that would not otherwise be apparent. Whether you are using plots for personal exploratory analysis or in a final presentation of your findings, they can transform a sheet of numbers into a decipherable and palatable image.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="visualization.html#cb131-1"></a><span class="co"># Read in the necessary packages for our work</span></span>
<span id="cb131-2"><a href="visualization.html#cb131-2"></a><span class="kw">library</span>(haven)</span>
<span id="cb131-3"><a href="visualization.html#cb131-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb131-4"><a href="visualization.html#cb131-4"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb131-5"><a href="visualization.html#cb131-5"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb131-6"><a href="visualization.html#cb131-6"></a></span>
<span id="cb131-7"><a href="visualization.html#cb131-7"></a><span class="co"># Read in the sav file, and filter it</span></span>
<span id="cb131-8"><a href="visualization.html#cb131-8"></a>raw.data &lt;-<span class="st"> </span><span class="kw">read_sav</span>(<span class="st">&#39;data/ypccc-hurricane.sav&#39;</span>)</span>
<span id="cb131-9"><a href="visualization.html#cb131-9"></a>raw.data &lt;-<span class="st"> </span>raw.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(raw.data<span class="op">$</span>Q1<span class="op">==</span><span class="dv">1</span> <span class="op">||</span><span class="st"> </span>raw.data<span class="op">$</span>Q2<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb131-10"><a href="visualization.html#cb131-10"></a>raw.data &lt;-<span class="st"> </span>raw.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(raw.data<span class="op">$</span>Q3), raw.data<span class="op">$</span>Q3<span class="op">!=</span><span class="dv">2</span>, raw.data<span class="op">$</span>Q3<span class="op">!=</span><span class="dv">3</span>)</span>
<span id="cb131-11"><a href="visualization.html#cb131-11"></a></span>
<span id="cb131-12"><a href="visualization.html#cb131-12"></a><span class="co"># Recode number codes into text labels</span></span>
<span id="cb131-13"><a href="visualization.html#cb131-13"></a>raw.data<span class="op">$</span>S5_cluster &lt;-<span class="st"> </span><span class="kw">recode</span>(<span class="kw">as.character</span>(raw.data<span class="op">$</span>S5_cluster), <span class="st">&#39;1&#39;</span>=<span class="st">&#39;DieHards&#39;</span>, <span class="st">&#39;2&#39;</span>=<span class="st">&#39;Reluctant&#39;</span>, <span class="st">&#39;4&#39;</span>=<span class="st">&#39;Optimists&#39;</span>, <span class="st">&#39;3&#39;</span>=<span class="st">&#39;Constrained&#39;</span>, <span class="st">&#39;5&#39;</span>=<span class="st">&#39;First Out&#39;</span>)</span>
<span id="cb131-14"><a href="visualization.html#cb131-14"></a></span>
<span id="cb131-15"><a href="visualization.html#cb131-15"></a><span class="co"># Save S5_cluster as a factor</span></span>
<span id="cb131-16"><a href="visualization.html#cb131-16"></a>raw.data<span class="op">$</span>S5_cluster &lt;-<span class="st"> </span><span class="kw">factor</span>(raw.data<span class="op">$</span>S5_cluster, <span class="dt">ordered=</span>T, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;First Out&#39;</span>, <span class="st">&#39;Constrained&#39;</span>, <span class="st">&#39;Optimists&#39;</span>, <span class="st">&#39;Reluctant&#39;</span>, <span class="st">&#39;DieHards&#39;</span>))</span>
<span id="cb131-17"><a href="visualization.html#cb131-17"></a></span>
<span id="cb131-18"><a href="visualization.html#cb131-18"></a><span class="co"># Keep only the non-missing data</span></span>
<span id="cb131-19"><a href="visualization.html#cb131-19"></a>data &lt;-<span class="st"> </span>raw.data[<span class="op">!</span><span class="kw">is.na</span>(raw.data<span class="op">$</span>S5_cluster),]</span></code></pre></div>
<p>The raw data that we will be using for this section covers Hurricanes and their attached attributes.</p>
<div id="setting-ggplot2-theme" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Setting <code>ggplot2</code> theme</h3>
<p>The ‘theme’ of ggplot2 is the aesthetic with which it produces every default plot or figure. By setting the theme, you are able to customize size, color palette, positioning of labels, font, text characteristics, and a whole series of other qualities which are well documented online. Below, we save a standard theme as ‘plot_theme’ so that we can use it later. Within the description, we clarify margins, text size, key size, and element sizes.</p>
<p>To set color, we use HTML color codes, a standard across many coding languages. Color can be described by a six character string, consisting of numbers and characters in hexadecimal form. You can go to this [website] (<a href="https://html-color.codes/" class="uri">https://html-color.codes/</a>) to access a color palette selector if there is a particular shade you want. You then pass this code as ‘# + xxxxxx’ to the color = () argument.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="visualization.html#cb132-1"></a><span class="co"># Save the plot theme</span></span>
<span id="cb132-2"><a href="visualization.html#cb132-2"></a>plot_theme &lt;-<span class="st"> </span></span>
<span id="cb132-3"><a href="visualization.html#cb132-3"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb132-4"><a href="visualization.html#cb132-4"></a>    <span class="co"># Describe margins and sizes </span></span>
<span id="cb132-5"><a href="visualization.html#cb132-5"></a>    <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb132-6"><a href="visualization.html#cb132-6"></a>    <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(),</span>
<span id="cb132-7"><a href="visualization.html#cb132-7"></a>    <span class="dt">legend.box.margin =</span> <span class="kw">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>),</span>
<span id="cb132-8"><a href="visualization.html#cb132-8"></a>    <span class="dt">legend.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb132-9"><a href="visualization.html#cb132-9"></a>    <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</span>
<span id="cb132-10"><a href="visualization.html#cb132-10"></a>    <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb132-11"><a href="visualization.html#cb132-11"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb132-12"><a href="visualization.html#cb132-12"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb132-13"><a href="visualization.html#cb132-13"></a>    <span class="co"># Describe production and color of the axes</span></span>
<span id="cb132-14"><a href="visualization.html#cb132-14"></a>    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>, <span class="dt">face=</span><span class="st">&#39;bold&#39;</span>),</span>
<span id="cb132-15"><a href="visualization.html#cb132-15"></a>    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&quot;#212F3D&quot;</span>),</span>
<span id="cb132-16"><a href="visualization.html#cb132-16"></a>    <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb132-17"><a href="visualization.html#cb132-17"></a>    <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>()</span>
<span id="cb132-18"><a href="visualization.html#cb132-18"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb132-19"><a href="visualization.html#cb132-19"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb132-20"><a href="visualization.html#cb132-20"></a>    <span class="co"># Describe the title and background</span></span>
<span id="cb132-21"><a href="visualization.html#cb132-21"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">face=</span><span class="st">&#39;bold&#39;</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">margin=</span><span class="kw">margin</span>(<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>)),</span>
<span id="cb132-22"><a href="visualization.html#cb132-22"></a>    <span class="dt">plot.background=</span><span class="kw">element_blank</span>() </span>
<span id="cb132-23"><a href="visualization.html#cb132-23"></a>  ) <span class="op">+</span></span>
<span id="cb132-24"><a href="visualization.html#cb132-24"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb132-25"><a href="visualization.html#cb132-25"></a>    <span class="co"># Describe the grid lines</span></span>
<span id="cb132-26"><a href="visualization.html#cb132-26"></a>    <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb132-27"><a href="visualization.html#cb132-27"></a>    <span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb132-28"><a href="visualization.html#cb132-28"></a>    <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb132-29"><a href="visualization.html#cb132-29"></a>  )</span>
<span id="cb132-30"><a href="visualization.html#cb132-30"></a></span>
<span id="cb132-31"><a href="visualization.html#cb132-31"></a><span class="co"># To see all information about your current theme, you can use theme_get()</span></span>
<span id="cb132-32"><a href="visualization.html#cb132-32"></a>description &lt;-<span class="st"> </span><span class="kw">theme_get</span>()</span></code></pre></div>
</div>
<div id="ggplot2-example-1-stacked-bar-plot" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> <code>ggplot2</code> Example 1: Stacked bar plot</h3>
<p>The first example we will provide is that of a stacked bar plot, which shows the statistics of distribution across categorical levels within a separate categorical level. For our example, we will show the percentage of Connecticut residents who understand that their home is in an evacuation zone, split across ‘First Out’, ‘Constrained’, ‘Optimists’, ‘Reluctant’, or ‘DieHards’. Plots like this one are good for getting a sense of how two categorical variables are related, much as you might observe in a two-way table or statistically evaluate with a Chi-square Test for Homogeneity.</p>
<p>Take a look at the code below for an example of a call to ggplot. First, we make sure that our data is saved as categorical variables, and that it is sorted and filtered appropriately. Next, we call ggplot() and pass it the dataframe we want to use, which in this case is Q31_Data, a new frame that has the points stored as percentages for each part of the stacked bars. The second argument we pass is aes(), which we can fill with details clarifying the aesthetic we want to use. The ‘x=’ is the data on the x-axis the ‘y=’ is the data on the y-axis. The fill is what distinguishes each segment of the stacked bar.</p>
<p>Once we have told ggplot() what data it will be using, we put ‘+’ and clarify the type of plot we want to construct, in this case geom_bar(). Every time we write ‘+’, it means that we are making a further adjustment to the existing plot under construction. We give arguments clarifying the aesthetics further, then stick on geom_text() to describe what labels to use, how to render them, and where to put them on the plot. To set the colors manually, we call scale_fill_manual() and pass the color codes we want used. Calling scale_y_continuous() lets us make the y-axis operate on a 0-100% scale. Using labs() lets us put the label text in manually, and theme() lets us clarify where we want that main title. The results can be seen below.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="visualization.html#cb133-1"></a><span class="co"># Q31. Is your home located in a hurricane evacuation zone, or not?</span></span>
<span id="cb133-2"><a href="visualization.html#cb133-2"></a>data<span class="op">$</span>Q31 &lt;-<span class="st"> </span><span class="kw">as_factor</span>(data<span class="op">$</span>Q31)</span>
<span id="cb133-3"><a href="visualization.html#cb133-3"></a>data<span class="op">$</span>Q31 &lt;-<span class="st"> </span><span class="kw">factor</span>(data<span class="op">$</span>Q31, <span class="dt">ordered=</span>T, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Not Sure&#39;</span>, <span class="st">&#39;Yes&#39;</span>))</span>
<span id="cb133-4"><a href="visualization.html#cb133-4"></a></span>
<span id="cb133-5"><a href="visualization.html#cb133-5"></a><span class="co"># Create the dataframe of just the relevant columns, summarized into sums and taken as a percentage</span></span>
<span id="cb133-6"><a href="visualization.html#cb133-6"></a>Q31_data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb133-7"><a href="visualization.html#cb133-7"></a><span class="st">  </span><span class="kw">select</span>(Q31, S5_cluster, Final_wgt_pop) <span class="op">%&gt;%</span></span>
<span id="cb133-8"><a href="visualization.html#cb133-8"></a><span class="st">  </span><span class="co"># na.omit() %&gt;%</span></span>
<span id="cb133-9"><a href="visualization.html#cb133-9"></a><span class="st">  </span><span class="kw">group_by</span>(S5_cluster, Q31) <span class="op">%&gt;%</span></span>
<span id="cb133-10"><a href="visualization.html#cb133-10"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Q31.wgt =</span> <span class="kw">sum</span>(Final_wgt_pop)) <span class="op">%&gt;%</span></span>
<span id="cb133-11"><a href="visualization.html#cb133-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">freq.wgt =</span> <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>Q31.wgt<span class="op">/</span><span class="kw">sum</span>(Q31.wgt))) <span class="op">%&gt;%</span></span>
<span id="cb133-12"><a href="visualization.html#cb133-12"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Q31))</span>
<span id="cb133-13"><a href="visualization.html#cb133-13"></a></span>
<span id="cb133-14"><a href="visualization.html#cb133-14"></a><span class="co"># Produce the plot, using the ggplot call</span></span>
<span id="cb133-15"><a href="visualization.html#cb133-15"></a><span class="kw">ggplot</span>(Q31_data, <span class="kw">aes</span>(<span class="dt">x=</span>S5_cluster, <span class="dt">y=</span>freq.wgt, <span class="dt">fill=</span>Q31)) <span class="op">+</span></span>
<span id="cb133-16"><a href="visualization.html#cb133-16"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>Q31), <span class="dt">width=</span>.<span class="dv">7</span>, <span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="op">+</span></span>
<span id="cb133-17"><a href="visualization.html#cb133-17"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>freq.wgt, <span class="dt">vjust=</span>.<span class="dv">5</span>), <span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">vjust =</span> <span class="fl">0.5</span>), <span class="dt">colour=</span><span class="st">&#39;white&#39;</span>, <span class="dt">size=</span><span class="dv">6</span>, <span class="dt">fontface=</span><span class="st">&#39;bold&#39;</span>) <span class="op">+</span></span>
<span id="cb133-18"><a href="visualization.html#cb133-18"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&#39;#DC7633&#39;</span>, <span class="st">&#39;#5D6D7E&#39;</span>, <span class="st">&#39;#5499C7&#39;</span>), <span class="dt">breaks=</span><span class="kw">c</span>(<span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;Not Sure&#39;</span>, <span class="st">&#39;No&#39;</span>)) <span class="op">+</span></span>
<span id="cb133-19"><a href="visualization.html#cb133-19"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> <span class="cf">function</span>(x) <span class="kw">paste0</span>(x, <span class="st">&quot;%&quot;</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span></span>
<span id="cb133-20"><a href="visualization.html#cb133-20"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;% of CT coastal residents who understand</span><span class="ch">\n</span><span class="st">that their home is in an evacuation zone&quot;</span>) <span class="op">+</span></span>
<span id="cb133-21"><a href="visualization.html#cb133-21"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb133-22"><a href="visualization.html#cb133-22"></a><span class="st">  </span>plot_theme <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.box.background =</span> <span class="kw">element_blank</span>(), <span class="dt">legend.spacing.x =</span> <span class="kw">unit</span>(.<span class="dv">2</span>, <span class="st">&#39;cm&#39;</span>))</span></code></pre></div>
<p><img src="edsy_files/figure-html/example-1-1.png" width="672" /></p>
<p>While it may seem overwhelming at first to use ggplot2, keep in mind that you can supply as much or as little detail and customization to your plot as you want. What we have done in this document is generate finely tuned plots to highlight a wide variety of customizable tools, but if your goal is to simply put the numbers in a plot, that can be done quite intuitively.</p>
</div>
<div id="ggplot2-example-2-grouped-bar-plot" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> <code>ggplot2</code> Example 2: Grouped bar plot</h3>
<p>If, instead of a stacked bar plot, you want to group the bars next to each other in sequence to get a sense not only of percentage but also total count, you can use a grouped bar plot as we have done below. For this example, we use the perception of people within each segment about how likely they think it is that a Category 1, 2, 3, or 4 hurricane will hit somewhere along the Connecticut coast in the next 50 years.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="visualization.html#cb134-1"></a><span class="co"># Q23. On a scale of 0%-100%, with 0% being it definitely will NOT happen and 100% being it definitely WILL happen, </span></span>
<span id="cb134-2"><a href="visualization.html#cb134-2"></a><span class="co"># how likely do you think it is that each of the following types of hurricane will hit somewhere along the </span></span>
<span id="cb134-3"><a href="visualization.html#cb134-3"></a><span class="co"># Connecticut coast in the next 50 years?</span></span>
<span id="cb134-4"><a href="visualization.html#cb134-4"></a>Q23_data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></span>
<span id="cb134-5"><a href="visualization.html#cb134-5"></a><span class="st">  </span><span class="kw">select</span>(S5_cluster, Q23_<span class="dv">1</span>, Q23_<span class="dv">2</span>, Q23_<span class="dv">3</span>, Q23_<span class="dv">4</span>, Final_wgt_pop) <span class="op">%&gt;%</span></span>
<span id="cb134-6"><a href="visualization.html#cb134-6"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span><span class="kw">one_of</span>(<span class="st">&#39;S5_cluster&#39;</span>, <span class="st">&#39;Final_wgt_pop&#39;</span>), <span class="dt">names_to=</span><span class="st">&quot;Category&quot;</span>, <span class="dt">names_prefix =</span> <span class="st">&quot;Q23_&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Q23&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb134-7"><a href="visualization.html#cb134-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Category =</span> <span class="kw">paste</span>(<span class="st">&quot;Category&quot;</span>, Category), <span class="dt">Q23.wgt =</span> Q23 <span class="op">*</span><span class="st"> </span>Final_wgt_pop) <span class="op">%&gt;%</span></span>
<span id="cb134-8"><a href="visualization.html#cb134-8"></a><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span></span>
<span id="cb134-9"><a href="visualization.html#cb134-9"></a><span class="st">  </span><span class="kw">group_by</span>(S5_cluster, Category) <span class="op">%&gt;%</span></span>
<span id="cb134-10"><a href="visualization.html#cb134-10"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">freq.wgt =</span> <span class="kw">round</span>(<span class="kw">sum</span>(Q23.wgt, <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">sum</span>(Final_wgt_pop, <span class="dt">na.rm=</span>T)))</span>
<span id="cb134-11"><a href="visualization.html#cb134-11"></a></span>
<span id="cb134-12"><a href="visualization.html#cb134-12"></a><span class="co"># Produce the plot</span></span>
<span id="cb134-13"><a href="visualization.html#cb134-13"></a><span class="kw">ggplot</span>(Q23_data, <span class="kw">aes</span>(<span class="dt">x=</span>S5_cluster, <span class="dt">y=</span>freq.wgt, <span class="dt">fill=</span>Category)) <span class="op">+</span></span>
<span id="cb134-14"><a href="visualization.html#cb134-14"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>Category), <span class="dt">width=</span>.<span class="dv">7</span>, <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">8</span>), <span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="op">+</span></span>
<span id="cb134-15"><a href="visualization.html#cb134-15"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>freq.wgt, <span class="dt">vjust=</span><span class="fl">1.2</span>), <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">8</span>), <span class="dt">colour=</span><span class="st">&#39;white&#39;</span>, <span class="dt">size=</span><span class="dv">6</span>, <span class="dt">fontface=</span><span class="st">&#39;bold&#39;</span>) <span class="op">+</span></span>
<span id="cb134-16"><a href="visualization.html#cb134-16"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&#39;#F6DDCC&#39;</span>, <span class="st">&#39;#EDBB99&#39;</span>, <span class="st">&#39;#E59866&#39;</span>, <span class="st">&#39;#DC7633&#39;</span>)) <span class="op">+</span></span>
<span id="cb134-17"><a href="visualization.html#cb134-17"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> <span class="cf">function</span>(x) <span class="kw">paste0</span>(x, <span class="st">&quot;%&quot;</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span></span>
<span id="cb134-18"><a href="visualization.html#cb134-18"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Average perception of each segment that</span><span class="ch">\n</span><span class="st">a Category 1, 2, 3, or 4 hurricane will occur</span><span class="ch">\n</span><span class="st">in the next 50 years&quot;</span>) <span class="op">+</span></span>
<span id="cb134-19"><a href="visualization.html#cb134-19"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb134-20"><a href="visualization.html#cb134-20"></a><span class="st">  </span>plot_theme <span class="op">+</span><span class="st"> </span></span>
<span id="cb134-21"><a href="visualization.html#cb134-21"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.box.background =</span> <span class="kw">element_blank</span>(), <span class="dt">legend.spacing.x =</span> <span class="kw">unit</span>(.<span class="dv">2</span>, <span class="st">&#39;cm&#39;</span>))</span></code></pre></div>
<p><img src="edsy_files/figure-html/example-2-1.png" width="672" /></p>
</div>
<div id="ggplot2-example-3-scatterplot" class="section level3" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> <code>ggplot2</code> Example 3: Scatterplot</h3>
<p>The plots below are examples of how to make a more complicated scatterplot. The data in the first plot describe state-level average annual temperature anomalies by average annual precipitation. In addition to the simple two-way scatterplot, we can also color the points by a third categorical variable, in this case the period of time in which the data were recorded. All labels can be customized as we do below, and we’ve added error bars to show uncertainty in a shaded gray region around the data.</p>
<p>We’ve commented out a line of code that can be used to save your plot as a .png file, which is the default image file type in R. You can customize the saved file’s name, height, and width within a call like this. Whenever we ask R to save a dataset, a file, a plot, or an image, it will assume that we want it in our current Working Directory. If, instead, you want to store the output somewhere else, you can clarify the path when you write out the name.</p>
<p>The second, simpler plot that we generated below displays California temperature anomalies by year. We are going to put a legend onto this plot with scale_color_gradient(), which is particularly helpful if the goal is to highlight a trend over the spread of the time series.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="visualization.html#cb135-1"></a><span class="co"># Scatterplot of state-level average annual temperature by avg annual precipitation (values and anomalies)</span></span>
<span id="cb135-2"><a href="visualization.html#cb135-2"></a><span class="co"># Data source: https://www.ncdc.noaa.gov/cag/statewide/time-series</span></span>
<span id="cb135-3"><a href="visualization.html#cb135-3"></a><span class="co"># Need to set base period from 1978 to 1998 in Options dialog and set parameters before downloading (12-Month)</span></span>
<span id="cb135-4"><a href="visualization.html#cb135-4"></a>ca.pcp &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/4-pcp-12-12-1978-2020.csv&#39;</span>, <span class="dt">skip=</span><span class="dv">4</span>)</span>
<span id="cb135-5"><a href="visualization.html#cb135-5"></a>ca.tavg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/4-tavg-12-12-1978-2020.csv&#39;</span>, <span class="dt">skip=</span><span class="dv">4</span>)</span>
<span id="cb135-6"><a href="visualization.html#cb135-6"></a></span>
<span id="cb135-7"><a href="visualization.html#cb135-7"></a><span class="co"># Reassign the column names</span></span>
<span id="cb135-8"><a href="visualization.html#cb135-8"></a><span class="kw">names</span>(ca.pcp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Precip&#39;</span>, <span class="st">&#39;Precip.Anomaly&#39;</span>)</span>
<span id="cb135-9"><a href="visualization.html#cb135-9"></a><span class="kw">names</span>(ca.tavg) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Temp&#39;</span>, <span class="st">&#39;Temp.Anomaly&#39;</span>)</span>
<span id="cb135-10"><a href="visualization.html#cb135-10"></a></span>
<span id="cb135-11"><a href="visualization.html#cb135-11"></a><span class="co"># Perform a left join and filter the data</span></span>
<span id="cb135-12"><a href="visualization.html#cb135-12"></a>ca.weather &lt;-<span class="st"> </span><span class="kw">left_join</span>(ca.tavg, ca.pcp, <span class="dt">by=</span><span class="st">&#39;Year&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb135-13"><a href="visualization.html#cb135-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year=</span><span class="kw">as.integer</span>(<span class="kw">substr</span>(Year, <span class="dv">1</span>, <span class="dv">4</span>)), </span>
<span id="cb135-14"><a href="visualization.html#cb135-14"></a>         <span class="dt">Period=</span><span class="kw">if_else</span>(Year<span class="op">&lt;</span><span class="dv">1990</span>, <span class="st">&#39;Before 1990&#39;</span>,</span>
<span id="cb135-15"><a href="visualization.html#cb135-15"></a>                         <span class="kw">if_else</span>(Year<span class="op">&lt;</span><span class="dv">2000</span>, <span class="st">&#39;1990-2000&#39;</span>,</span>
<span id="cb135-16"><a href="visualization.html#cb135-16"></a>                                 <span class="kw">if_else</span>(Year<span class="op">&lt;</span><span class="dv">2010</span>, <span class="st">&#39;2000-2010&#39;</span>, <span class="st">&#39;Since 2010&#39;</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb135-17"><a href="visualization.html#cb135-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Period=</span><span class="kw">factor</span>(Period, <span class="kw">c</span>(<span class="st">&#39;Before 1990&#39;</span>, <span class="st">&#39;1990-2000&#39;</span>, <span class="st">&#39;2000-2010&#39;</span>, <span class="st">&#39;Since 2010&#39;</span>)))</span>
<span id="cb135-18"><a href="visualization.html#cb135-18"></a></span>
<span id="cb135-19"><a href="visualization.html#cb135-19"></a><span class="co"># Produce the base ggplot</span></span>
<span id="cb135-20"><a href="visualization.html#cb135-20"></a>s &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> ca.weather, <span class="kw">aes</span>(<span class="dt">x=</span>Temp.Anomaly, <span class="dt">y=</span>Precip.Anomaly))</span>
<span id="cb135-21"><a href="visualization.html#cb135-21"></a>hottest.v &lt;-<span class="st"> </span><span class="kw">max</span>(ca.weather<span class="op">$</span>Temp.Anomaly)</span>
<span id="cb135-22"><a href="visualization.html#cb135-22"></a>hottest.y &lt;-<span class="st"> </span><span class="kw">filter</span>(ca.weather, Temp.Anomaly<span class="op">==</span>hottest.v)<span class="op">$</span>Year</span>
<span id="cb135-23"><a href="visualization.html#cb135-23"></a>driest.v &lt;-<span class="st"> </span><span class="kw">min</span>(ca.weather<span class="op">$</span>Precip.Anomaly)</span>
<span id="cb135-24"><a href="visualization.html#cb135-24"></a>driest.y &lt;-<span class="st"> </span><span class="kw">filter</span>(ca.weather, Precip.Anomaly<span class="op">==</span>driest.v)<span class="op">$</span>Year</span>
<span id="cb135-25"><a href="visualization.html#cb135-25"></a></span>
<span id="cb135-26"><a href="visualization.html#cb135-26"></a><span class="co"># Print the plot with all of the adjustments</span></span>
<span id="cb135-27"><a href="visualization.html#cb135-27"></a>s <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-28"><a href="visualization.html#cb135-28"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Period), <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb135-29"><a href="visualization.html#cb135-29"></a><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span></span>
<span id="cb135-30"><a href="visualization.html#cb135-30"></a><span class="st">  </span><span class="kw">geom_label</span>(<span class="dt">label=</span><span class="kw">if_else</span>(ca.weather<span class="op">$</span>Temp.Anomaly<span class="op">==</span>hottest.v, <span class="kw">paste</span>(<span class="st">&#39;Hottest Year</span><span class="ch">\n</span><span class="st">&#39;</span>, hottest.y), <span class="ot">NULL</span>), <span class="dt">nudge_x =</span> <span class="fl">-.2</span>, <span class="dt">nudge_y =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb135-31"><a href="visualization.html#cb135-31"></a><span class="st">  </span><span class="kw">geom_label</span>(<span class="dt">label=</span><span class="kw">if_else</span>(ca.weather<span class="op">$</span>Precip.Anomaly<span class="op">==</span>driest.v, <span class="kw">paste</span>(<span class="st">&#39;Driest Year</span><span class="ch">\n</span><span class="st">&#39;</span>, driest.y), <span class="ot">NULL</span>), <span class="dt">nudge_x =</span> <span class="fl">-.4</span>, <span class="dt">nudge_y =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb135-32"><a href="visualization.html#cb135-32"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&#39;Hotter and Drier Wildfire Seasons in California&#39;</span>, <span class="dt">subtitle=</span><span class="st">&#39;Precipitation vs. temperature anomalies in California from January to October over 40 years (1978-2020)&#39;</span>, <span class="dt">caption=</span><span class="st">&#39;Data from NOAA&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Precipitation anomaly (inches)&#39;</span>, <span class="dt">x=</span><span class="st">&#39;Temperature anomaly (°F)&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-33"><a href="visualization.html#cb135-33"></a><span class="st">  </span><span class="kw">theme_light</span>() </span></code></pre></div>
<p><img src="edsy_files/figure-html/example-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="visualization.html#cb136-1"></a><span class="co"># Save as png file</span></span>
<span id="cb136-2"><a href="visualization.html#cb136-2"></a><span class="co"># ggsave(file = &#39;CA.weather.png&#39;, height=9, width=12)</span></span>
<span id="cb136-3"><a href="visualization.html#cb136-3"></a></span>
<span id="cb136-4"><a href="visualization.html#cb136-4"></a><span class="co"># Produce our second, simpler scatterplot</span></span>
<span id="cb136-5"><a href="visualization.html#cb136-5"></a><span class="kw">ggplot</span>(ca.weather, <span class="kw">aes</span>(Year, Temp.Anomaly)) <span class="op">+</span></span>
<span id="cb136-6"><a href="visualization.html#cb136-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color=</span><span class="st">&#39;#0D47A1&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Temp.Anomaly)) <span class="op">+</span></span>
<span id="cb136-7"><a href="visualization.html#cb136-7"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype=</span><span class="dv">2</span>, <span class="dt">color=</span><span class="st">&#39;#aaaaaa&#39;</span>) <span class="op">+</span></span>
<span id="cb136-8"><a href="visualization.html#cb136-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&#39;California Temperature Anomaly 1978-2020&#39;</span>) <span class="op">+</span></span>
<span id="cb136-9"><a href="visualization.html#cb136-9"></a><span class="st">  </span><span class="kw">scale_color_gradient</span>(<span class="dt">low=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">high=</span><span class="st">&#39;red&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb136-10"><a href="visualization.html#cb136-10"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="edsy_files/figure-html/example-3-2.png" width="672" /></p>
</div>
</div>
<div id="animated-graph-with-gganimate" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Animated graph with <code>gganimate</code></h2>
<p>To make a plot dynamically animated for insertion into a webpage, presentation, or any platform that supports gif images, we can simply add <code>gganimate</code> to the plot’s code. After choosing the aesthetic elements of the plot, write the transition_reveal() code, and clarify the sequence along which points should emerge, to get the result that we see below.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="visualization.html#cb137-1"></a><span class="kw">library</span>(gganimate)</span>
<span id="cb137-2"><a href="visualization.html#cb137-2"></a>animated.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ca.weather, <span class="kw">aes</span>(Year, Temp.Anomaly)) <span class="op">+</span></span>
<span id="cb137-3"><a href="visualization.html#cb137-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color=</span><span class="st">&#39;#0D47A1&#39;</span>) <span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Temp.Anomaly)) <span class="op">+</span></span>
<span id="cb137-4"><a href="visualization.html#cb137-4"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">linetype=</span><span class="dv">2</span>, <span class="dt">color=</span><span class="st">&#39;#aaaaaa&#39;</span>) <span class="op">+</span></span>
<span id="cb137-5"><a href="visualization.html#cb137-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&#39;California Temperature Anomaly 1978-2020&#39;</span>) <span class="op">+</span></span>
<span id="cb137-6"><a href="visualization.html#cb137-6"></a><span class="st">  </span><span class="kw">scale_color_gradient</span>(<span class="dt">low=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">high=</span><span class="st">&#39;red&#39;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-7"><a href="visualization.html#cb137-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb137-8"><a href="visualization.html#cb137-8"></a><span class="st">  </span><span class="co"># labels</span></span>
<span id="cb137-9"><a href="visualization.html#cb137-9"></a><span class="st">  </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">label=</span><span class="kw">as.character</span>(Year)), <span class="dt">nudge_y=</span>.<span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb137-10"><a href="visualization.html#cb137-10"></a><span class="st">  </span><span class="co"># gganimate code</span></span>
<span id="cb137-11"><a href="visualization.html#cb137-11"></a><span class="st">  </span><span class="kw">transition_reveal</span>(<span class="kw">seq_along</span>(Year))</span>
<span id="cb137-12"><a href="visualization.html#cb137-12"></a><span class="co"># animate(animated.plot)</span></span></code></pre></div>
<div class="figure">
<img src="images/gganim.gif" alt="" />
<p class="caption">gganim</p>
</div>
</div>
<div id="interactive-graph-with-plotly" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Interactive graph with <code>plotly</code></h2>
<p>Creating an interactive version of the previous graphs is pretty simple using <code>plotly</code>. You just have to separate the data by group, which we do in the plot below through a series of filter commands from tidyverse. The benefit to creating an interactive graph is that the user can explore specific data, compare data by hovering over boxes, or move about the plot itself. This level of interactivity makes their reception of the data more nuanced, and may answer questions that a static plot would not.</p>
<div id="plotly-example-1-interactive-version-of-the-stacked-bar" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> <code>plotly</code> Example 1: Interactive version of the stacked bar</h3>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="visualization.html#cb138-1"></a><span class="kw">library</span>(plotly)</span>
<span id="cb138-2"><a href="visualization.html#cb138-2"></a></span>
<span id="cb138-3"><a href="visualization.html#cb138-3"></a><span class="co"># Split and filter the data</span></span>
<span id="cb138-4"><a href="visualization.html#cb138-4"></a>Q31.yes &lt;-<span class="st"> </span>Q31_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb138-5"><a href="visualization.html#cb138-5"></a><span class="st">  </span><span class="kw">filter</span>(Q31<span class="op">==</span><span class="st">&#39;Yes&#39;</span>)</span>
<span id="cb138-6"><a href="visualization.html#cb138-6"></a>Q31.notsure &lt;-<span class="st"> </span>Q31_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb138-7"><a href="visualization.html#cb138-7"></a><span class="st">  </span><span class="kw">filter</span>(Q31<span class="op">==</span><span class="st">&#39;Not Sure&#39;</span>)</span>
<span id="cb138-8"><a href="visualization.html#cb138-8"></a>Q31.no &lt;-<span class="st"> </span>Q31_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb138-9"><a href="visualization.html#cb138-9"></a><span class="st">  </span><span class="kw">filter</span>(Q31<span class="op">==</span><span class="st">&#39;No&#39;</span>)</span>
<span id="cb138-10"><a href="visualization.html#cb138-10"></a></span>
<span id="cb138-11"><a href="visualization.html#cb138-11"></a><span class="co"># Produce the plotly object</span></span>
<span id="cb138-12"><a href="visualization.html#cb138-12"></a><span class="kw">plot_ly</span>(<span class="dt">x=</span>Q31.yes<span class="op">$</span>S5_cluster, <span class="dt">y=</span>Q31.yes<span class="op">$</span>freq.wgt, <span class="dt">type=</span><span class="st">&#39;bar&#39;</span>, <span class="dt">name=</span><span class="st">&#39;Yes&#39;</span>, <span class="dt">marker =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&#39;#DC7633&#39;</span>), <span class="dt">text =</span> Q31.yes<span class="op">$</span>freq.wgt, <span class="dt">textposition =</span> <span class="st">&#39;auto&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb138-13"><a href="visualization.html#cb138-13"></a><span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x=</span>Q31.notsure<span class="op">$</span>S5_cluster, <span class="dt">y=</span>Q31.notsure<span class="op">$</span>freq.wgt, <span class="dt">name=</span><span class="st">&#39;Not Sure&#39;</span>, <span class="dt">marker =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&#39;#5D6D7E&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb138-14"><a href="visualization.html#cb138-14"></a><span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x=</span>Q31.no<span class="op">$</span>S5_cluster, <span class="dt">y=</span>Q31.no<span class="op">$</span>freq.wgt, <span class="dt">name=</span><span class="st">&#39;No&#39;</span>, <span class="dt">marker =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&#39;#5499C7&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb138-15"><a href="visualization.html#cb138-15"></a><span class="st">  </span><span class="kw">layout</span>(<span class="dt">barmode =</span> <span class="st">&#39;stack&#39;</span>)</span></code></pre></div>
<div id="htmlwidget-8b3cc01b5ec1aa04e889" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8b3cc01b5ec1aa04e889">{"x":{"visdat":{"1bc47af6a98":["function () ","plotlyVisDat"]},"cur_data":"1bc47af6a98","attrs":{"1bc47af6a98":{"x":["First Out","Constrained","Optimists","Reluctant","DieHards"],"y":[58,34,20,14,30],"marker":{"color":"#DC7633"},"text":[58,34,20,14,30],"textposition":"auto","name":"Yes","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"1bc47af6a98.1":{"x":["First Out","Constrained","Optimists","Reluctant","DieHards"],"y":[32,51,60,54,41],"marker":{"color":"#5D6D7E"},"text":[58,34,20,14,30],"textposition":"auto","name":"Not Sure","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true},"1bc47af6a98.2":{"x":["First Out","Constrained","Optimists","Reluctant","DieHards"],"y":[8,14,18,32,29],"marker":{"color":"#5499C7"},"text":[58,34,20,14,30],"textposition":"auto","name":"No","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"barmode":"stack","xaxis":{"domain":[0,1],"automargin":true,"title":[],"type":"category","categoryorder":"array","categoryarray":["First Out","Constrained","Optimists","Reluctant","DieHards"]},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["First Out","Constrained","Optimists","Reluctant","DieHards"],"y":[58,34,20,14,30],"marker":{"color":"#DC7633","line":{"color":"rgba(31,119,180,1)"}},"text":[58,34,20,14,30],"textposition":["auto","auto","auto","auto","auto"],"name":"Yes","type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["First Out","Constrained","Optimists","Reluctant","DieHards"],"y":[32,51,60,54,41],"marker":{"color":"#5D6D7E","line":{"color":"rgba(255,127,14,1)"}},"text":[58,34,20,14,30],"textposition":["auto","auto","auto","auto","auto"],"name":"Not Sure","type":"bar","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["First Out","Constrained","Optimists","Reluctant","DieHards"],"y":[8,14,18,32,29],"marker":{"color":"#5499C7","line":{"color":"rgba(44,160,44,1)"}},"text":[58,34,20,14,30],"textposition":["auto","auto","auto","auto","auto"],"name":"No","type":"bar","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>You can find more examples of using <code>plotly</code> on their <a href="https://plotly.com/r/">website</a>.</p>
</div>
</div>
<div id="web-app-with-rshiny" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Web app with RShiny</h2>
<p><em>This Shiny tutorial was edited based on the official tutorial on the <a href="https://shiny.rstudio.com/tutorial/">website</a></em></p>
<p>With RShiny, it is possible to make functions in your R script available to people who do not necessarily know R. For example, in this <a href="https://udwq.shinyapps.io/lakeprofiledashboard/">app</a>, you can create different types of graphs by selecting site, plot type, and other parameters. It uses the power of R libraries to create interactive plots for exploration.</p>
<p>Just like any other web tool, an RshinyApp has components on the User and Server side.
<img src="images/appStructure.png" alt="Rshiny app structure" /></p>
<p>The visual appearance of the app can be modified in the user component. You can change layout, font size, color, etc. On the server side, you can customize how your app responds to user inputs or interactions, what options to make available, and what the default presentation is. If you are running this code simultaneously in your own RStudio window, the code below will generate a new panel in which the ShinyApp object lives. Because we have not built it out yet, you will see an empty window if you run the code below:</p>
<p>A basic <strong>ShinyApp starter template</strong> looks like this:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="visualization.html#cb139-1"></a><span class="kw">library</span>(shiny)</span>
<span id="cb139-2"><a href="visualization.html#cb139-2"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>()</span>
<span id="cb139-3"><a href="visualization.html#cb139-3"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){}</span>
<span id="cb139-4"><a href="visualization.html#cb139-4"></a><span class="kw">shinyApp</span>(<span class="dt">ui=</span>ui, <span class="dt">server=</span>server)</span></code></pre></div>
<p>Some content will show up when you add some (text) elements with <code>fluidPage</code>, as we do below.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="visualization.html#cb140-1"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(<span class="st">&#39;Hello world&#39;</span>)</span>
<span id="cb140-2"><a href="visualization.html#cb140-2"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){}</span>
<span id="cb140-3"><a href="visualization.html#cb140-3"></a><span class="kw">shinyApp</span>(<span class="dt">ui=</span>ui, <span class="dt">server=</span>server)</span></code></pre></div>
<div id="input-functions" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Input functions</h3>
<p>For richer content, the <code>shiny</code> package has built-in functions that allow you to insert various applications, information, and interactive elements. We will demonstrate one of them, <code>sliderInput</code>, which adds a slider into your web app.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="visualization.html#cb141-1"></a><span class="co"># Generate a user slider from 1 to 100</span></span>
<span id="cb141-2"><a href="visualization.html#cb141-2"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb141-3"><a href="visualization.html#cb141-3"></a>  <span class="kw">sliderInput</span>(<span class="dt">inputId=</span><span class="st">&#39;num&#39;</span>,</span>
<span id="cb141-4"><a href="visualization.html#cb141-4"></a>              <span class="dt">label=</span><span class="st">&#39;Choose a number&#39;</span>,</span>
<span id="cb141-5"><a href="visualization.html#cb141-5"></a>              <span class="dt">value=</span><span class="dv">25</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">100</span>)</span>
<span id="cb141-6"><a href="visualization.html#cb141-6"></a>)</span>
<span id="cb141-7"><a href="visualization.html#cb141-7"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){}</span>
<span id="cb141-8"><a href="visualization.html#cb141-8"></a><span class="kw">shinyApp</span>(<span class="dt">ui=</span>ui, <span class="dt">server=</span>server)</span></code></pre></div>
<p><code>sliderInput</code> is part of a group of functions called <strong>inputs</strong>. These functions allow an Rshiny developer to add html elements which gather and record user input. Here are some input functions you can try:
<img src="images/inputFunctions.png" alt="Rshiny input functions" /></p>
<p>All input functions require 2 arguments: <code>inputId</code> and <code>label</code>. <code>inputId</code> is an ID that R will use when it creates the input element in a webpage, so that it can be referenced later. <code>label</code> is text that the user will see, describing what the input element is meant to be used for. The rest of the arguments are function-specific and can be explored at the full tutorial we linked earlier.</p>
</div>
<div id="output-functions" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Output functions</h3>
<p>Output functions allow you to add outputs of R code into your web page. These outputs can be images, plots, tables, text, or any other result of an R command. There are specific output functions for each type of output.</p>
<div class="figure">
<img src="images/outputFunctions.png" alt="" />
<p class="caption">Rshiny output functions</p>
</div>
<p>Output functions have a similar set of syntactic rules to the input functions:
<img src="images/callOutputFunctions.png" alt="Rshiny output functions" /></p>
<p>Here is the code for our app, now including an output function. Running this script won’t display any plot. It just reserves a space in the webpage for a plot with the assigned id ‘hist’. To actually create the plot, you must use the server function.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="visualization.html#cb142-1"></a><span class="co"># Produce a shinyApp with an output function</span></span>
<span id="cb142-2"><a href="visualization.html#cb142-2"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb142-3"><a href="visualization.html#cb142-3"></a>  <span class="kw">sliderInput</span>(<span class="dt">inputId=</span><span class="st">&#39;num&#39;</span>,</span>
<span id="cb142-4"><a href="visualization.html#cb142-4"></a>              <span class="dt">label=</span><span class="st">&#39;Choose a number&#39;</span>,</span>
<span id="cb142-5"><a href="visualization.html#cb142-5"></a>              <span class="dt">value=</span><span class="dv">25</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">100</span>),</span>
<span id="cb142-6"><a href="visualization.html#cb142-6"></a>  <span class="kw">plotOutput</span>(<span class="st">&#39;hist&#39;</span>)</span>
<span id="cb142-7"><a href="visualization.html#cb142-7"></a>)</span>
<span id="cb142-8"><a href="visualization.html#cb142-8"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){}</span>
<span id="cb142-9"><a href="visualization.html#cb142-9"></a><span class="kw">shinyApp</span>(<span class="dt">ui=</span>ui, <span class="dt">server=</span>server)</span></code></pre></div>
</div>
<div id="server-function" class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Server function</h3>
<p>Server functions facilitate the interactivity in your web application. This is where you set up how an output (ex: graph) changes with the user input (ex: some number). However, there are 3 rules that have to be followed, which we have printed in this script:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="visualization.html#cb143-1"></a><span class="cf">function</span>(input, output){</span>
<span id="cb143-2"><a href="visualization.html#cb143-2"></a>  <span class="co">#1 outputId is the outputId you defined with output function</span></span>
<span id="cb143-3"><a href="visualization.html#cb143-3"></a>  <span class="co">#2 To render a plot on a webpage, use renderPlot()</span></span>
<span id="cb143-4"><a href="visualization.html#cb143-4"></a>  output<span class="op">$</span>outputId &lt;-<span class="st"> </span><span class="kw">renderSomething</span>({</span>
<span id="cb143-5"><a href="visualization.html#cb143-5"></a>    <span class="co">#3 inputId is the inputId you defined with input function</span></span>
<span id="cb143-6"><a href="visualization.html#cb143-6"></a>    <span class="kw">someFunction</span>(input<span class="op">$</span>inputId)</span>
<span id="cb143-7"><a href="visualization.html#cb143-7"></a>  })</span>
<span id="cb143-8"><a href="visualization.html#cb143-8"></a>}</span>
<span id="cb143-9"><a href="visualization.html#cb143-9"></a><span class="co"># Anything inside the curly braces is an R code. And it can be multiple lines of code.</span></span></code></pre></div>
<p>You must define your output variable using <code>outputId</code> prefixed with <code>output$</code> then call the R script that will produce the output with a <code>render*({})</code> function. After this is done, you must call the user input with its <code>inputId</code> and prefix it with <code>input$</code>.</p>
<p>In our example script, we render a plot as follows:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="visualization.html#cb144-1"></a><span class="co"># Save the ui as &#39;ui&#39;</span></span>
<span id="cb144-2"><a href="visualization.html#cb144-2"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb144-3"><a href="visualization.html#cb144-3"></a>  <span class="co"># Generate the slider input, give it a label and range</span></span>
<span id="cb144-4"><a href="visualization.html#cb144-4"></a>  <span class="kw">sliderInput</span>(<span class="dt">inputId=</span><span class="st">&#39;num&#39;</span>,</span>
<span id="cb144-5"><a href="visualization.html#cb144-5"></a>              <span class="dt">label=</span><span class="st">&#39;Choose a number&#39;</span>,</span>
<span id="cb144-6"><a href="visualization.html#cb144-6"></a>              <span class="dt">value=</span><span class="dv">25</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">100</span>),</span>
<span id="cb144-7"><a href="visualization.html#cb144-7"></a>  <span class="co"># Plot the output as a histogram</span></span>
<span id="cb144-8"><a href="visualization.html#cb144-8"></a>  <span class="kw">plotOutput</span>(<span class="st">&#39;hist&#39;</span>)</span>
<span id="cb144-9"><a href="visualization.html#cb144-9"></a>)</span>
<span id="cb144-10"><a href="visualization.html#cb144-10"></a></span>
<span id="cb144-11"><a href="visualization.html#cb144-11"></a><span class="co"># Define the function of our server</span></span>
<span id="cb144-12"><a href="visualization.html#cb144-12"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){</span>
<span id="cb144-13"><a href="visualization.html#cb144-13"></a>    <span class="co"># Create the call for renderPlot()</span></span>
<span id="cb144-14"><a href="visualization.html#cb144-14"></a>    output<span class="op">$</span>hist &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</span>
<span id="cb144-15"><a href="visualization.html#cb144-15"></a>      <span class="co"># Give a title and histogram command, with input from the slider</span></span>
<span id="cb144-16"><a href="visualization.html#cb144-16"></a>      title &lt;-<span class="st"> </span><span class="kw">paste</span>(input<span class="op">$</span>num, <span class="st">&#39;random normal values&#39;</span>)</span>
<span id="cb144-17"><a href="visualization.html#cb144-17"></a>      <span class="kw">hist</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>num), <span class="dt">main=</span>title, <span class="dt">xlab=</span><span class="st">&#39;values&#39;</span>)</span>
<span id="cb144-18"><a href="visualization.html#cb144-18"></a>  })</span>
<span id="cb144-19"><a href="visualization.html#cb144-19"></a>}</span>
<span id="cb144-20"><a href="visualization.html#cb144-20"></a></span>
<span id="cb144-21"><a href="visualization.html#cb144-21"></a><span class="co"># Produce the Rshiny app</span></span>
<span id="cb144-22"><a href="visualization.html#cb144-22"></a><span class="kw">shinyApp</span>(<span class="dt">ui=</span>ui, <span class="dt">server=</span>server)</span></code></pre></div>
<p>To make more advanced applications, we highly encourage you to read the instructions on the <a href="https://shiny.rstudio.com/articles/">Rshiny website</a>.</p>
</div>
<div id="sharing-your-app" class="section level3" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Sharing your app</h3>
<p>You now possess the tools you need to create your own Shiny app. In its current form, it will only run on your computer, which means nobody else has access to it. To make it available to the public, you must:</p>
<ol style="list-style-type: decimal">
<li>Save the <code>ui</code> and <code>server</code> objects/scripts into their own R script, name this script <code>app.R</code>, and save it in a separate folder. The name must be <code>app.R</code> as that is the file that the server will look for when you deploy your app. For this example, we have saved the app we’ve been working on as <code>app.R</code></li>
</ol>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="visualization.html#cb145-1"></a><span class="co"># Saved version of our shinyApp</span></span>
<span id="cb145-2"><a href="visualization.html#cb145-2"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb145-3"><a href="visualization.html#cb145-3"></a>  <span class="kw">sliderInput</span>(<span class="dt">inputId=</span><span class="st">&#39;num&#39;</span>,</span>
<span id="cb145-4"><a href="visualization.html#cb145-4"></a>              <span class="dt">label=</span><span class="st">&#39;Choose a number&#39;</span>,</span>
<span id="cb145-5"><a href="visualization.html#cb145-5"></a>              <span class="dt">value=</span><span class="dv">25</span>, <span class="dt">min=</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">100</span>),</span>
<span id="cb145-6"><a href="visualization.html#cb145-6"></a>  <span class="kw">plotOutput</span>(<span class="st">&#39;hist&#39;</span>)</span>
<span id="cb145-7"><a href="visualization.html#cb145-7"></a>)</span>
<span id="cb145-8"><a href="visualization.html#cb145-8"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output){</span>
<span id="cb145-9"><a href="visualization.html#cb145-9"></a>    output<span class="op">$</span>hist &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</span>
<span id="cb145-10"><a href="visualization.html#cb145-10"></a>      title &lt;-<span class="st"> </span><span class="kw">paste</span>(input<span class="op">$</span>num, <span class="st">&#39;random normal values&#39;</span>)</span>
<span id="cb145-11"><a href="visualization.html#cb145-11"></a>      <span class="kw">hist</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>num), <span class="dt">main=</span>title, <span class="dt">xlab=</span><span class="st">&#39;values&#39;</span>)</span>
<span id="cb145-12"><a href="visualization.html#cb145-12"></a>  })</span>
<span id="cb145-13"><a href="visualization.html#cb145-13"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Go to <a href="https://www.shinyapps.io">shinyapps.io</a> and log in or sign up for an account.</li>
<li>Run the app on your computer</li>
<li>In the top right cover of R viewer window, there will now be a <code>Publish</code> button that you can use to publish your app.</li>
<li>Follow the prompted instructions to publish.</li>
</ol>
</div>
</div>
<div id="more-data-visualization-resources" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> More data visualization resources</h2>
<p>More data visualization resources can be found in this <a href="https://docs.google.com/spreadsheets/d/156QjpOgLCiDlcmkhJ0RQTVjFYBld8qAhaZsgT7He7b4">spreadsheet</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cleaning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rajaoberison/edsy/edit/master/06-visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["edsy.pdf", "edsy.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
